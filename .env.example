# Docker环境变量配置

# Web服务端口
WEB_PORT=5000

# Nginx端口 (如果启用)
NGINX_HTTP_PORT=80
NGINX_HTTPS_PORT=443

# 日志级别 (DEBUG, INFO, WARNING, ERROR)
LOG_LEVEL=INFO

# 管理后台密码（生产环境建议设置）
ADMIN_PASSWORD=your-secure-password

# Flask session 加密密钥（生产环境必填；多进程/多实例必须固定，否则登录态会随机失效）
# 生成方式示例：python -c "import secrets; print(secrets.token_hex(32))"
SECRET_KEY=

# Team 凭证（推荐使用 base64，避免换行/转义问题）
# TEAM_JSON_B64=<base64(team.json)>
# 或直接传原始 JSON（可能需要转义/单行）
# TEAM_JSON=[{"user":{"email":"..."},"account":{"id":"...","organizationId":"..."},"accessToken":"..."}]

# SQLite 数据库文件路径（可选）
REDEMPTION_DATABASE_FILE=redemption.db

# DATA_DIR: æ•°æ®ç›®å½•ï¼ˆZeabur Volume å»ºè®®æŒ‚è½½åˆ° /dataï¼‰
DATA_DIR=/data

# REDEMPTION_CODE_LOCK_SECONDS: å…‘æ¢ç å¹¶å‘é”å®šç§’æ•°ï¼ˆé¿å…å¹¶å‘å¯¼è‡´è¶…å‘ï¼‰
REDEMPTION_CODE_LOCK_SECONDS=120

# TRUST_PROXY: åå‘ä»£ç†ä¿¡ä»»ï¼ˆèŽ·å–ç”¨æˆ·çœŸå®ž IPï¼‰
TRUST_PROXY=true

# 时区
TZ=Asia/Shanghai

# ==================== 自动转移配置 ====================
# 到期转移（按月到期后自动邀请到新 Team）
# 说明：不会"踢出旧 Team"，只会在到期后重新发送新 Team 邀请邮件；默认关闭以避免影响现有系统。
AUTO_TRANSFER_ENABLED=false
AUTO_TRANSFER_TERM_MONTHS=1
AUTO_TRANSFER_POLL_SECONDS=300
# 是否强制踢出旧 Team 成员（需要后端接口支持；开启后若踢人失败将不会转移）
AUTO_TRANSFER_KICK_OLD_TEAM=false
# 是否自动退出旧 Team（等价于"踢出旧 Team"，只是命名更贴近业务；建议使用此变量）
AUTO_TRANSFER_AUTO_LEAVE_OLD_TEAM=false

# ==================== Team 状态检测 ====================
# 定期检测所有 Team 的 Token 是否有效，提前发现问题
TEAM_STATUS_CHECK_ENABLED=true
TEAM_STATUS_CHECK_INTERVAL=10800  # 检测间隔（秒），默认 10800 = 3 小时

# ==================== 异常转移检测 ⭐ ====================
# 定期检查活跃租约的 Team 状态，如果 Team 不可用则立即转移（不等待到期）
# 确保用户始终可用，实现无感切换
ABNORMAL_TRANSFER_CHECK_ENABLED=true
ABNORMAL_TRANSFER_CHECK_INTERVAL=1800  # 检测间隔（秒），默认 1800 = 30 分钟

# ==================== 监控和告警 ====================
# 系统监控和告警功能（Team 席位、转移失败、数据库性能等）
MONITOR_ENABLED=true
MONITOR_INTERVAL=300  # 检测间隔（秒），默认 300 = 5 分钟
